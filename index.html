<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Les webperfs pour les nuls</title>
  <meta name="description" content="Présentation PerfUG Août 2014">
  <meta name="author" content="Timothée Carry">
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="css/reveal.min.css">
  <link rel="stylesheet" href="css/theme/octo.css" id="theme">
  <link rel="stylesheet" href="css/custom.css">
  <link rel="stylesheet" href="lib/css/zenburn.css">
  <script>
    if (window.location.search.match(/print-pdf/gi)) {
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = 'css/print/pdf.css';
      document.getElementsByTagName('head')[0].appendChild(link);
    }
  </script>
  <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>
  <div class="reveal">
    <div class="slides">

      <!--HOME-->
      <section>
        <h1>Concatenate</h1>
        <h1>Compress</h1>
        <h1>Cache</h1>
      </section>

      <!--WHO AM I ?-->
      <section>
        <h2>Timothée Carry</h2>
        <ul>
          <li>Consultant Octo Technology</li>
          <li>Spécialiste en Web Front</li>
          <li><a href="https://twitter.com/pixelastic/">@pixelastic</a> à l'extérieur</li>
        </ul>
      </section>

      <!--CONCATENATE-->
      <section>
        <section>
          <h1>Concatenate</h1>
          <h3>Télécharger moins de fichiers</h3>
        </section>

        <section>
          <h3>france.fr</h3>
          <p><img src="./img/concatenate-france.png" alt="Waterfall france.fr" /></p>
          <h3>github.com</h3>
          <p><img src="./img/concatenate-github.png" alt="Waterfall github.com" /></p>
        </section>

        <section>
          <h3>Coûts incompressibles</h3>
          <ul>
            <li>Latence DNS</li>
            <li>TCP Slow-start</li>
            <li>Overhead SSL</li>
            <li>Maximum de connections parallèlles</li>
          </ul>
        </section>
      </section>

      <!--COMPRESS-->
      <section>
        <section>
          <h1>Compress</h1>
          <h3>Télécharger des fichiers plus légers</h3>
        </section>

        <section>
          <img src="./img/compress-gzip.jpg" alt="GZIP ALL TEH THINGS!" />
        </section>

        <section>
          <h3>GZIP : La formule magique</h3>
          <ul>
            <li>Gain de 66% en moyenne</li>
            <li>Assets textuels : HTML, CSS, Javascript, XML, JSON</li>
            <li>Serveur : Apache, Lighttpd, Nginx, IIS</li>
            <li>Browser : IE5.5+</li>
          </ul>
          <aside class="notes">
            <p>Attention aux proxies.</p>
            <p>Peuvent décompresser à la volée ou supprimer <code>Accept-Encoding</code> requête, ou <code>Content-Encoding</code> réponse</p>
          </aside>
        </section>

        <section>
          <h4>Apache</h4>
          <pre><code>&lt;IfModule mod_deflate.c&gt;
  &lt;IfModule mod_filter.c&gt;
    AddOutputFilterByType DEFLATE "application/javascript" "application/json" \
"text/css" "text/html" "text/xml" [...]
  &lt;/IfModule&gt;
&lt;/IfModule&gt;</code></pre>
          <h4>Lighttpd</h4>
          <pre><code>server.modules += ( "mod_compress" )
compress.filetype  = ("application/javascript", "application/json", \
"text/css", "text/html", "text/xml", [...] )</code></pre>
          <h4>nginx</h4>
          <pre><code>gzip on;
gzip_types application/javascript application/json text/css text/html text/xml [...]; </code></pre>
        </section>

      </section>

      <!--CACHE-->
      <section>
        <section>
          <h1>Cache</h1>
          <h3>Télécharger moins souvent</h3>
        </section>

        <section>
          <h3>Fraicheur</h3>
          <ul>
            <li>Date limite de consommation</li>
            <li>Rapide, pas de requete si encore frais</li>
            <li>
              <p>Deux headers</p>
              <ul>
                <li><code>Expires: Thu, 04 May 2014 20:00:00 GMT</code> ✘</li>
                <li><code>Cache-Control: max-age=3600, must-revalidate</code> ✔</li>
              </ul>
            </li>
          </ul>
          <aside class="notes">
            <p>Expires accepte une date absolue, GMT</p>
            <p>Cache-Control accepte une date relative, forcer avec <code>no-cache</code></p>
            <p>Toujours mettre <code>must-revalidate</code> pour être sur de ne pas servir du pas frais</p>
          </aside>
        </section>

        <section>
          <h3>Validation</h3>
          <ul>
            <li>
              <p>Vérification que le client possède la dernière version</p>
              <ul>
                <li>Oui : 304 - Not Modified</li>
                <li>Non: 200 - OK</li>
              </ul>
            </li>
            <li>Évite téléchargement inutile</li>
            <li>
              <p>Deux couples de headers</p>
              <ul>
                <li><code>Last-Modified: Mon, 04 May 2014 02:28:12 GMT</code> / <code>If-Modified-Since</code> ✔</li>
                <li><code>ETag: "3e86-410-3596fbbc"</code> / <code>If-None-Match</code> ✘</li>
              </ul>
            </li>
          </ul>
          <aside class="notes">
            <p>Browser recoit <code>Last-Modified</code> en réponse, et renvoie <code>If-Modified-Since</code> en requete</p>
            <p>Attention <code>ETag : collisions, génération en fonction inode, donc différent si shardé.</code></p>
            <p><code>Pragma: no-cache</code> n'est pas un header de response</p>
          </aside>
        </section>


        <section>
          <h3>Un beau dessin</h3>
          <p><img src="./img/cache-graph.png" alt="Le cache dans un beau dessin" /></p>
        </section>

        <section>
          <h3>Invalidation</h3>
          <blockquote>There are only two hard things in Computer Science: cache invalidation and naming things.</blockquote>
          <ul>
            <li>Cache max (1 an)</li>
            <li>
              <p>Nouvelles urls (timestamp, hash, etc)</p>
              <ul>
                <li>github2-c9b5fd6520f5ab77dd823b1b2c81ff9c461b1374.css</li>
                <li>github-14e2a44e296739b8ec8d7763e88ed307a6d424e0.js</li>
              </ul>
            </li>
          </ul>
        </section>
      </section>

      <!--QUESTIONS-->
      <section data-background="./img/questions-bg.jpg">
        <h1>Questions ?</h1>
      </section>
    </div>

  </div>

  <script src="lib/js/head.min.js"></script>
  <script src="js/reveal.min.js"></script>

  <script>
    // Full list of configuration options available here:
     // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
      controls: false,
      progress: true,
      history: true,
      center: true,

      transition: 'linear',

      // Optional libraries used to extend on reveal.js
      dependencies: [{
        src: 'lib/js/classList.js',
        condition: function() {
          return !document.body.classList;
        }
      }, {
        src: 'plugin/highlight/highlight.js',
        async: true,
        callback: function() {
          hljs.initHighlightingOnLoad();
        }
      }, {
        src: 'plugin/notes/notes.js',
        async: true,
        condition: function() {
          return !!document.body.classList;
        }
      }]
    });
  </script>

</body>

</html>
